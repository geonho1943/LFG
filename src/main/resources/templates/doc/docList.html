<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>게시판 목록보기</title>
  <link rel="stylesheet" href="reset.css">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="header.css">
  <link rel="stylesheet" href="board.css" />
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
  <div class="container">
    <div class="header_dis">
      <header class="header">
        <div class="header_logo">
          <a href="/">
            <H1> LFG Doc</H1>
          </a>
        </div>
        <span class="header_interface">
          <ul>
            <span class="user-info" th:if="${loginInfo != null}">
              <a href="/logout">로그아웃</a>
              <a th:text="${loginInfo.user_name}"></a>
              <a href="/myProfile">내 프로필</a>
              <a href="/docWrite">글쓰기</a>

            </span>
            <span class="user-info_null" th:if="${loginInfo == null}">
              <a href="/userLogin">로그인</a>
              <a href="/userJoin">회원가입</a>
            </span>
          </ul>
        </span>
      </header>
    </div>
    <!-- board list area -->
    <div id="board-list"
      style="background-color: #3E4551; border-top-right-radius: 10px;border-top-left-radius: 10px; padding: 10px;">
      <table>
        <label for="search_name">게임 검색: </label>
        <input
          style="width: 400px; height: 30px; border: 0; border-radius: 10px; outline: none; padding-left: 10px;background-color: #DCDDD8;"
          id="search_name" oninput="search_name()" type="text" placeholder="게임명을 입력하세요">
        <ul id="name-list-container"></ul>
        <tbody>
          <div th:each="doc : ${docs}"
            style="background-color: #4B515D; margin: 20px; margin: 5px; border-radius: 10px; padding: 10px; height: 150px;">
            <div th:text="${doc.doc_idx}"></div>
            <a th:href="@{/docDetail(doc_idx=${doc.doc_idx})}" th:text="${doc.doc_sub}"></a>
            <div th:text="${doc.doc_writ}"></div>
            <div class="appid" th:data-appid="${doc.doc_app_id}"></div>
            <img class="game-image" alt="이미지 위치">
            <div th:text="${doc.doc_reg}"></div>
          </div>
        </tbody>
      </table>
    </div>
  </div>
</body>
<script>
  $('.appid').each(function () {
    var appid = $(this).data('appid');
    var url = "https://cdn.akamai.steamstatic.com/steam/apps/" + appid + "/header.jpg";
    $(this).next('.game-image').attr("src", url);
  });


  function search_name() {
    var name = document.getElementById('search_name').value;
    if (name.length > 3) {
      $.ajax({
        url: './searchApp', type: 'post', data: { name: name },
        success: function (apps) {
          var listContainer = document.getElementById('name-list-container');
          while (listContainer.firstChild) {
            listContainer.removeChild(listContainer.firstChild);
          }
          apps.forEach(function (name) {
            var item = document.createElement('li');
            $('li').css({
              "background-color": "#DCDDD8",
              "display": "inline-block",
              "width": "400px",
              "height": "30px",
              "border": "0",
              "border-radius": "10px",
              "outline": "none",
              "padding-left": "10px",
              "padding-bottom": "5px",
              "margin-left": "70px"
            })
            item.textContent = name;
            listContainer.appendChild(item);
          });
        },
      });
    }

  }
</script>

</html>